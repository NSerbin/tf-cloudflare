name: Apply Terraform Code

on:
  push:
    branches:
      - main
    tags:
    - "*"

permissions:
  contents: write
  pull-requests: write

jobs:
  tf_plan:
    uses: NSerbin/gh-pipelines/.github/workflows/tf-apply.yml@new-way-to-deploy
    with:
      terraform_version: 1.12.2
    secrets: inherit
  tf_check:
    needs: tf_plan
    uses: NSerbin/gh-pipelines/.github/workflows/tf-apply.yml@new-way-to-deploy
    with:
      terraform_version: 1.12.2
    secrets: inherit